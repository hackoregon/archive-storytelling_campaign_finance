<html>
<head>
  <title>Phase 1</title>
  <script src="lib/lodash.min.js"></script>
  <script src="lib/d3/d3.min.js"></script>
  <script src="lib/jquery-2.1.3.min.js"></script>
</head>
<body>


  <script>
    d3.json('json/committees.json', function(committees){
      var requests = [];
      var committeeData = {};
      _.forEach(committees, function(committee){
        var request = $.getJSON('http://54.213.83.132/hackoregon/http/candidate_sum_by_date/'+committee.committeeId + '/');
        request.then(function(data){
          committeeData[committee.committeeId] = data;
        })
        requests.push(request);
      });
      $.when.apply($, requests).then(function(){
        console.log(committeeData);
      });
    });
  </script>
</body>
</html>
